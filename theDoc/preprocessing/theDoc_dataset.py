
# coding: utf-8

# In[27]:

import numpy as np


class query:

    def __init__(self,inference_gids_str=None,training_gids_str='all'):
        
        self.batter_columnarray = [
            #'anal_game_date',
            #'batter',
            #'pname',
            'outsmade_pa_std',
            'hits_pa_std',
            'avg_std',
            'obp_std',
            'sba_pa_std',
            'sba_o_std',
            'rba_pa_std',
            'rba_o_std',
            'tba_pa_std',
            'tba_o_std',
            'k_pa_std',
            'klook_pa_std',
            'kswing_pa_std',
            'walk_pa_std',
            'singles_pa_std',
            'doubles_pa_std',
            'triples_pa_std',
            'homeruns_pa_std',
            'sacs_pa_std',
            'groundballs_pa_std',
            'linedrives_pa_std',
            'outsmade_pa_last60',
            'hits_pa_last60',
            'avg_last60',
            'obp_last60',
            'sba_pa_last60',
            'sba_o_last60',
            'rba_pa_last60',
            'rba_o_last60',
            'tba_pa_last60',
            'tba_o_last60',
            'k_pa_last60',
            'klook_pa_last60',
            'kswing_pa_last60',
            'walk_pa_last60',
            'singles_pa_last60',
            'doubles_pa_last60',
            'triples_pa_last60',
            'homeruns_pa_last60',
            'sacs_pa_last60',
            'groundballs_pa_last60',
            'linedrives_pa_last60',
            'outsmade_pa_last30',
            'hits_pa_last30',
            'avg_last30',
            'obp_last30',
            'sba_pa_last30',
            'sba_o_last30',
            'rba_pa_last30',
            'rba_o_last30',
            'tba_pa_last30',
            'tba_o_last30',
            'k_pa_last30',
            'klook_pa_last30',
            'kswing_pa_last30',
            'walk_pa_last30',
            'singles_pa_last30',
            'doubles_pa_last30',
            'triples_pa_last30',
            'homeruns_pa_last30',
            'sacs_pa_last30',
            'groundballs_pa_last30',
            'linedrives_pa_last30',
            'outsmade_pa_last10',
            'hits_pa_last10',
            'avg_last10',
            'obp_last10',
            'sba_pa_last10',
            'sba_o_last10',
            'rba_pa_last10',
            'rba_o_last10',
            'tba_pa_last10',
            'tba_o_last10',
            'k_pa_last10',
            'klook_pa_last10',
            'kswing_pa_last10',
            'walk_pa_last10',
            'singles_pa_last10',
            'doubles_pa_last10',
            'triples_pa_last10',
            'homeruns_pa_last10',
            'sacs_pa_last10',
            'groundballs_pa_last10',
            'linedrives_pa_last10',
            'outsmade_pa_std2',
            'hits_pa_std2',
            'avg_std2',
            'obp_std2',
            'sba_pa_std2',
            'sba_o_std2',
            'rba_pa_std2',
            'rba_o_std2',
            'tba_pa_std2',
            'tba_o_std2',
            'k_pa_std2',
            'klook_pa_std2',
            'kswing_pa_std2',
            'walk_pa_std2',
            'singles_pa_std2',
            'doubles_pa_std2',
            'triples_pa_std2',
            'homeruns_pa_std2',
            'sacs_pa_std2',
            'groundballs_pa_std2',
            'linedrives_pa_std2',
            'outsmade_pa_std3',
            'hits_pa_std3',
            'avg_std3',
            'obp_std3',
            'sba_pa_std3',
            'sba_o_std3',
            'rba_pa_std3',
            'rba_o_std3',
            'tba_pa_std3',
            'tba_o_std3',
            'k_pa_std3',
            'klook_pa_std3',
            'kswing_pa_std3',
            'walk_pa_std3',
            'singles_pa_std3',
            'doubles_pa_std3',
            'triples_pa_std3',
            'homeruns_pa_std3',
            'sacs_pa_std3',
            'groundballs_pa_std3',
            'linedrives_pa_std3',
            'outsmade_pa_std_rh',
            'hits_pa_std_rh',
            'avg_std_rh',
            'obp_std_rh',
            'sba_pa_std_rh',
            'sba_o_std_rh',
            'rba_pa_std_rh',
            'rba_o_std_rh',
            'tba_pa_std_rh',
            'tba_o_std_rh',
            'k_pa_std_rh',
            'klook_pa_std_rh',
            'kswing_pa_std_rh',
            'walk_pa_std_rh',
            'singles_pa_std_rh',
            'doubles_pa_std_rh',
            'triples_pa_std_rh',
            'homeruns_pa_std_rh',
            'sacs_pa_std_rh',
            'groundballs_pa_std_rh',
            'linedrives_pa_std_rh',
            'outsmade_pa_last60_rh',
            'hits_pa_last60_rh',
            'avg_last60_rh',
            'obp_last60_rh',
            'sba_pa_last60_rh',
            'sba_o_last60_rh',
            'rba_pa_last60_rh',
            'rba_o_last60_rh',
            'tba_pa_last60_rh',
            'tba_o_last60_rh',
            'k_pa_last60_rh',
            'klook_pa_last60_rh',
            'kswing_pa_last60_rh',
            'walk_pa_last60_rh',
            'singles_pa_last60_rh',
            'doubles_pa_last60_rh',
            'triples_pa_last60_rh',
            'homeruns_pa_last60_rh',
            'sacs_pa_last60_rh',
            'groundballs_pa_last60_rh',
            'linedrives_pa_last60_rh',
            'outsmade_pa_last30_rh',
            'hits_pa_last30_rh',
            'avg_last30_rh',
            'obp_last30_rh',
            'sba_pa_last30_rh',
            'sba_o_last30_rh',
            'rba_pa_last30_rh',
            'rba_o_last30_rh',
            'tba_pa_last30_rh',
            'tba_o_last30_rh',
            'k_pa_last30_rh',
            'klook_pa_last30_rh',
            'kswing_pa_last30_rh',
            'walk_pa_last30_rh',
            'singles_pa_last30_rh',
            'doubles_pa_last30_rh',
            'triples_pa_last30_rh',
            'homeruns_pa_last30_rh',
            'sacs_pa_last30_rh',
            'groundballs_pa_last30_rh',
            'linedrives_pa_last30_rh',
            'outsmade_pa_last10_rh',
            'hits_pa_last10_rh',
            'avg_last10_rh',
            'obp_last10_rh',
            'sba_pa_last10_rh',
            'sba_o_last10_rh',
            'rba_pa_last10_rh',
            'rba_o_last10_rh',
            'tba_pa_last10_rh',
            'tba_o_last10_rh',
            'k_pa_last10_rh',
            'klook_pa_last10_rh',
            'kswing_pa_last10_rh',
            'walk_pa_last10_rh',
            'singles_pa_last10_rh',
            'doubles_pa_last10_rh',
            'triples_pa_last10_rh',
            'homeruns_pa_last10_rh',
            'sacs_pa_last10_rh',
            'groundballs_pa_last10_rh',
            'linedrives_pa_last10_rh',
            'outsmade_pa_std2_rh',
            'hits_pa_std2_rh',
            'avg_std2_rh',
            'obp_std2_rh',
            'sba_pa_std2_rh',
            'sba_o_std2_rh',
            'rba_pa_std2_rh',
            'rba_o_std2_rh',
            'tba_pa_std2_rh',
            'tba_o_std2_rh',
            'k_pa_std2_rh',
            'klook_pa_std2_rh',
            'kswing_pa_std2_rh',
            'walk_pa_std2_rh',
            'singles_pa_std2_rh',
            'doubles_pa_std2_rh',
            'triples_pa_std2_rh',
            'homeruns_pa_std2_rh',
            'sacs_pa_std2_rh',
            'groundballs_pa_std2_rh',
            'linedrives_pa_std2_rh',
            'outsmade_pa_std3_rh',
            'hits_pa_std3_rh',
            'avg_std3_rh',
            'obp_std3_rh',
            'sba_pa_std3_rh',
            'sba_o_std3_rh',
            'rba_pa_std3_rh',
            'rba_o_std3_rh',
            'tba_pa_std3_rh',
            'tba_o_std3_rh',
            'k_pa_std3_rh',
            'klook_pa_std3_rh',
            'kswing_pa_std3_rh',
            'walk_pa_std3_rh',
            'singles_pa_std3_rh',
            'doubles_pa_std3_rh',
            'triples_pa_std3_rh',
            'homeruns_pa_std3_rh',
            'sacs_pa_std3_rh',
            'groundballs_pa_std3_rh',
            'linedrives_pa_std3_rh',
            'outsmade_pa_std_lh',
            'hits_pa_std_lh',
            'avg_std_lh',
            'obp_std_lh',
            'sba_pa_std_lh',
            'sba_o_std_lh',
            'rba_pa_std_lh',
            'rba_o_std_lh',
            'tba_pa_std_lh',
            'tba_o_std_lh',
            'k_pa_std_lh',
            'klook_pa_std_lh',
            'kswing_pa_std_lh',
            'walk_pa_std_lh',
            'singles_pa_std_lh',
            'doubles_pa_std_lh',
            'triples_pa_std_lh',
            'homeruns_pa_std_lh',
            'sacs_pa_std_lh',
            'groundballs_pa_std_lh',
            'linedrives_pa_std_lh',
            'outsmade_pa_last60_lh',
            'hits_pa_last60_lh',
            'avg_last60_lh',
            'obp_last60_lh',
            'sba_pa_last60_lh',
            'sba_o_last60_lh',
            'rba_pa_last60_lh',
            'rba_o_last60_lh',
            'tba_pa_last60_lh',
            'tba_o_last60_lh',
            'k_pa_last60_lh',
            'klook_pa_last60_lh',
            'kswing_pa_last60_lh',
            'walk_pa_last60_lh',
            'singles_pa_last60_lh',
            'doubles_pa_last60_lh',
            'triples_pa_last60_lh',
            'homeruns_pa_last60_lh',
            'sacs_pa_last60_lh',
            'groundballs_pa_last60_lh',
            'linedrives_pa_last60_lh',
            'outsmade_pa_last30_lh',
            'hits_pa_last30_lh',
            'avg_last30_lh',
            'obp_last30_lh',
            'sba_pa_last30_lh',
            'sba_o_last30_lh',
            'rba_pa_last30_lh',
            'rba_o_last30_lh',
            'tba_pa_last30_lh',
            'tba_o_last30_lh',
            'k_pa_last30_lh',
            'klook_pa_last30_lh',
            'kswing_pa_last30_lh',
            'walk_pa_last30_lh',
            'singles_pa_last30_lh',
            'doubles_pa_last30_lh',
            'triples_pa_last30_lh',
            'homeruns_pa_last30_lh',
            'sacs_pa_last30_lh',
            'groundballs_pa_last30_lh',
            'linedrives_pa_last30_lh',
            'outsmade_pa_last10_lh',
            'hits_pa_last10_lh',
            'avg_last10_lh',
            'obp_last10_lh',
            'sba_pa_last10_lh',
            'sba_o_last10_lh',
            'rba_pa_last10_lh',
            'rba_o_last10_lh',
            'tba_pa_last10_lh',
            'tba_o_last10_lh',
            'k_pa_last10_lh',
            'klook_pa_last10_lh',
            'kswing_pa_last10_lh',
            'walk_pa_last10_lh',
            'singles_pa_last10_lh',
            'doubles_pa_last10_lh',
            'triples_pa_last10_lh',
            'homeruns_pa_last10_lh',
            'sacs_pa_last10_lh',
            'groundballs_pa_last10_lh',
            'linedrives_pa_last10_lh',
            'outsmade_pa_std2_lh',
            'hits_pa_std2_lh',
            'avg_std2_lh',
            'obp_std2_lh',
            'sba_pa_std2_lh',
            'sba_o_std2_lh',
            'rba_pa_std2_lh',
            'rba_o_std2_lh',
            'tba_pa_std2_lh',
            'tba_o_std2_lh',
            'k_pa_std2_lh',
            'klook_pa_std2_lh',
            'kswing_pa_std2_lh',
            'walk_pa_std2_lh',
            'singles_pa_std2_lh',
            'doubles_pa_std2_lh',
            'triples_pa_std2_lh',
            'homeruns_pa_std2_lh',
            'sacs_pa_std2_lh',
            'groundballs_pa_std2_lh',
            'linedrives_pa_std2_lh',
            'outsmade_pa_std3_lh',
            'hits_pa_std3_lh',
            'avg_std3_lh',
            'obp_std3_lh',
            'sba_pa_std3_lh',
            'sba_o_std3_lh',
            'rba_pa_std3_lh',
            'rba_o_std3_lh',
            'tba_pa_std3_lh',
            'tba_o_std3_lh',
            'k_pa_std3_lh',
            'klook_pa_std3_lh',
            'kswing_pa_std3_lh',
            'walk_pa_std3_lh',
            'singles_pa_std3_lh',
            'doubles_pa_std3_lh',
            'triples_pa_std3_lh',
            'homeruns_pa_std3_lh',
            'sacs_pa_std3_lh',
            'groundballs_pa_std3_lh',
            'linedrives_pa_std3_lh'
            ]

        self.sides = ['home','away']
        self.batpositions = ['1','2','3','4','5','6','7','8','9']

        self.pitcher_columnarray = [

            #'anal_game_date',
            #'pitcher',
            #'pname',
            'outsmade_pa_std',
            'hits_pa_std',
            'avg_std',
            'obp_std',
            'tba_pa_std',
            'tba_o_std',
            'k_pa_std',
            'klook_pa_std',
            'kswing_pa_std',
            'walk_pa_std',
            'singles_pa_std',
            'doubles_pa_std',
            'triples_pa_std',
            'homeruns_pa_std',
            'groundballs_pa_std',
            'linedrives_pa_std',
            'ball_p_std',
            'ball_pa_std',
            'strike_p_std',
            'strike_pa_std',
            'calledstrike_strike_std',
            'whiffstrike_strike_std',
            'foulstrike_strike_std',
            'inplay_strike_std',
            'calledstrike_pa_std',
            'whiffstrike_pa_std',
            'foulstrike_pa_std',
            'inplay_pa_std',
            'swing_p_std',
            'take_p_std',
            'swing_pa_std',
            'take_pa_std',
            'firstpstrike_pa_std',
            'secondpstrike_pa_std',
            'zoneedge_in2_p_std',
            'zoneedge_in4_p_std',
            'zoneedge_out2_p_std',
            'zoneedge_out4_p_std',
            'zonecorn_in2_p_std',
            'zonecorn_in4_p_std',
            'zonecorn_out2_p_std',
            'zonecorn_out4_p_std',
            'zone_mid3_p_std',
            'zone_mid6_p_std',
            'zone_bigmiss4_p_std',
            'fastball_p_std',
            'fastball_endspeed_p_std',
            'fastball_spinrate_p_std',
            'fastball_spindir_p_std',
            'fastball_pfx_x_p_std',
            'fastball_pfx_z_p_std',
            'fastball_mnorm_p_std',
            'fastball_adjmnorm_p_std',
            'curveball_p_std',
            'curveball_endspeed_p_std',
            'curveball_spinrate_p_std',
            'curveball_spindir_p_std',
            'curveball_pfx_x_p_std',
            'curveball_pfx_z_p_std',
            'curveball_mnorm_p_std',
            'curveball_adjmnorm_p_std',
            'slider_p_std',
            'slider_endspeed_p_std',
            'slider_spinrate_p_std',
            'slider_spindir_p_std',
            'slider_pfx_x_p_std',
            'slider_pfx_z_p_std',
            'slider_mnorm_p_std',
            'slider_adjmnorm_p_std',
            'changeup_p_std',
            'changeup_endspeed_p_std',
            'changeup_spinrate_p_std',
            'changeup_spindir_p_std',
            'changeup_pfx_x_p_std',
            'changeup_pfx_z_p_std',
            'changeup_mnorm_p_std',
            'changeup_adjmnorm_p_std',
            'outsmade_pa_std2',
            'hits_pa_std2',
            'avg_std2',
            'obp_std2',
            'tba_pa_std2',
            'tba_o_std2',
            'k_pa_std2',
            'klook_pa_std2',
            'kswing_pa_std2',
            'walk_pa_std2',
            'singles_pa_std2',
            'doubles_pa_std2',
            'triples_pa_std2',
            'homeruns_pa_std2',
            'groundballs_pa_std2',
            'linedrives_pa_std2',
            'ball_p_std2',
            'ball_pa_std2',
            'strike_p_std2',
            'strike_pa_std2',
            'calledstrike_strike_std2',
            'whiffstrike_strike_std2',
            'foulstrike_strike_std2',
            'inplay_strike_std2',
            'calledstrike_pa_std2',
            'whiffstrike_pa_std2',
            'foulstrike_pa_std2',
            'inplay_pa_std2',
            'swing_p_std2',
            'take_p_std2',
            'swing_pa_std2',
            'take_pa_std2',
            'firstpstrike_pa_std2',
            'secondpstrike_pa_std2',
            'zoneedge_in2_p_std2',
            'zoneedge_in4_p_std2',
            'zoneedge_out2_p_std2',
            'zoneedge_out4_p_std2',
            'zonecorn_in2_p_std2',
            'zonecorn_in4_p_std2',
            'zonecorn_out2_p_std2',
            'zonecorn_out4_p_std2',
            'zone_mid3_p_std2',
            'zone_mid6_p_std2',
            'zone_bigmiss4_p_std2',
            'fastball_p_std2',
            'fastball_endspeed_p_std2',
            'fastball_spinrate_p_std2',
            'fastball_spindir_p_std2',
            'fastball_pfx_x_p_std2',
            'fastball_pfx_z_p_std2',
            'fastball_mnorm_p_std2',
            'fastball_adjmnorm_p_std2',
            'curveball_p_std2',
            'curveball_endspeed_p_std2',
            'curveball_spinrate_p_std2',
            'curveball_spindir_p_std2',
            'curveball_pfx_x_p_std2',
            'curveball_pfx_z_p_std2',
            'curveball_mnorm_p_std2',
            'curveball_adjmnorm_p_std2',
            'slider_p_std2',
            'slider_endspeed_p_std2',
            'slider_spinrate_p_std2',
            'slider_spindir_p_std2',
            'slider_pfx_x_p_std2',
            'slider_pfx_z_p_std2',
            'slider_mnorm_p_std2',
            'slider_adjmnorm_p_std2',
            'changeup_p_std2',
            'changeup_endspeed_p_std2',
            'changeup_spinrate_p_std2',
            'changeup_spindir_p_std2',
            'changeup_pfx_x_p_std2',
            'changeup_pfx_z_p_std2',
            'changeup_mnorm_p_std2',
            'changeup_adjmnorm_p_std2',
            'outsmade_pa_std3',
            'hits_pa_std3',
            'avg_std3',
            'obp_std3',
            'tba_pa_std3',
            'tba_o_std3',
            'k_pa_std3',
            'klook_pa_std3',
            'kswing_pa_std3',
            'walk_pa_std3',
            'singles_pa_std3',
            'doubles_pa_std3',
            'triples_pa_std3',
            'homeruns_pa_std3',
            'groundballs_pa_std3',
            'linedrives_pa_std3',
            'ball_p_std3',
            'ball_pa_std3',
            'strike_p_std3',
            'strike_pa_std3',
            'calledstrike_strike_std3',
            'whiffstrike_strike_std3',
            'foulstrike_strike_std3',
            'inplay_strike_std3',
            'calledstrike_pa_std3',
            'whiffstrike_pa_std3',
            'foulstrike_pa_std3',
            'inplay_pa_std3',
            'swing_p_std3',
            'take_p_std3',
            'swing_pa_std3',
            'take_pa_std3',
            'firstpstrike_pa_std3',
            'secondpstrike_pa_std3',
            'zoneedge_in2_p_std3',
            'zoneedge_in4_p_std3',
            'zoneedge_out2_p_std3',
            'zoneedge_out4_p_std3',
            'zonecorn_in2_p_std3',
            'zonecorn_in4_p_std3',
            'zonecorn_out2_p_std3',
            'zonecorn_out4_p_std3',
            'zone_mid3_p_std3',
            'zone_mid6_p_std3',
            'zone_bigmiss4_p_std3',
            'fastball_p_std3',
            'fastball_endspeed_p_std3',
            'fastball_spinrate_p_std3',
            'fastball_spindir_p_std3',
            'fastball_pfx_x_p_std3',
            'fastball_pfx_z_p_std3',
            'fastball_mnorm_p_std3',
            'fastball_adjmnorm_p_std3',
            'curveball_p_std3',
            'curveball_endspeed_p_std3',
            'curveball_spinrate_p_std3',
            'curveball_spindir_p_std3',
            'curveball_pfx_x_p_std3',
            'curveball_pfx_z_p_std3',
            'curveball_mnorm_p_std3',
            'curveball_adjmnorm_p_std3',
            'slider_p_std3',
            'slider_endspeed_p_std3',
            'slider_spinrate_p_std3',
            'slider_spindir_p_std3',
            'slider_pfx_x_p_std3',
            'slider_pfx_z_p_std3',
            'slider_mnorm_p_std3',
            'slider_adjmnorm_p_std3',
            'changeup_p_std3',
            'changeup_endspeed_p_std3',
            'changeup_spinrate_p_std3',
            'changeup_spindir_p_std3',
            'changeup_pfx_x_p_std3',
            'changeup_pfx_z_p_std3',
            'changeup_mnorm_p_std3',
            'changeup_adjmnorm_p_std3',
            'outsmade_pa_last60',
            'hits_pa_last60',
            'avg_last60',
            'obp_last60',
            'tba_pa_last60',
            'tba_o_last60',
            'k_pa_last60',
            'klook_pa_last60',
            'kswing_pa_last60',
            'walk_pa_last60',
            'singles_pa_last60',
            'doubles_pa_last60',
            'triples_pa_last60',
            'homeruns_pa_last60',
            'groundballs_pa_last60',
            'linedrives_pa_last60',
            'ball_p_last60',
            'ball_pa_last60',
            'strike_p_last60',
            'strike_pa_last60',
            'calledstrike_strike_last60',
            'whiffstrike_strike_last60',
            'foulstrike_strike_last60',
            'inplay_strike_last60',
            'calledstrike_pa_last60',
            'whiffstrike_pa_last60',
            'foulstrike_pa_last60',
            'inplay_pa_last60',
            'swing_p_last60',
            'take_p_last60',
            'swing_pa_last60',
            'take_pa_last60',
            'firstpstrike_pa_last60',
            'secondpstrike_pa_last60',
            'zoneedge_in2_p_last60',
            'zoneedge_in4_p_last60',
            'zoneedge_out2_p_last60',
            'zoneedge_out4_p_last60',
            'zonecorn_in2_p_last60',
            'zonecorn_in4_p_last60',
            'zonecorn_out2_p_last60',
            'zonecorn_out4_p_last60',
            'zone_mid3_p_last60',
            'zone_mid6_p_last60',
            'zone_bigmiss4_p_last60',
            'fastball_p_last60',
            'fastball_endspeed_p_last60',
            'fastball_spinrate_p_last60',
            'fastball_spindir_p_last60',
            'fastball_pfx_x_p_last60',
            'fastball_pfx_z_p_last60',
            'fastball_mnorm_p_last60',
            'fastball_adjmnorm_p_last60',
            'curveball_p_last60',
            'curveball_endspeed_p_last60',
            'curveball_spinrate_p_last60',
            'curveball_spindir_p_last60',
            'curveball_pfx_x_p_last60',
            'curveball_pfx_z_p_last60',
            'curveball_mnorm_p_last60',
            'curveball_adjmnorm_p_last60',
            'slider_p_last60',
            'slider_endspeed_p_last60',
            'slider_spinrate_p_last60',
            'slider_spindir_p_last60',
            'slider_pfx_x_p_last60',
            'slider_pfx_z_p_last60',
            'slider_mnorm_p_last60',
            'slider_adjmnorm_p_last60',
            'changeup_p_last60',
            'changeup_endspeed_p_last60',
            'changeup_spinrate_p_last60',
            'changeup_spindir_p_last60',
            'changeup_pfx_x_p_last60',
            'changeup_pfx_z_p_last60',
            'changeup_mnorm_p_last60',
            'changeup_adjmnorm_p_last60',
            'outsmade_pa_last20',
            'hits_pa_last20',
            'avg_last20',
            'obp_last20',
            'tba_pa_last20',
            'tba_o_last20',
            'k_pa_last20',
            'klook_pa_last20',
            'kswing_pa_last20',
            'walk_pa_last20',
            'singles_pa_last20',
            'doubles_pa_last20',
            'triples_pa_last20',
            'homeruns_pa_last20',
            'groundballs_pa_last20',
            'linedrives_pa_last20',
            'ball_p_last20',
            'ball_pa_last20',
            'strike_p_last20',
            'strike_pa_last20',
            'calledstrike_strike_last20',
            'whiffstrike_strike_last20',
            'foulstrike_strike_last20',
            'inplay_strike_last20',
            'calledstrike_pa_last20',
            'whiffstrike_pa_last20',
            'foulstrike_pa_last20',
            'inplay_pa_last20',
            'swing_p_last20',
            'take_p_last20',
            'swing_pa_last20',
            'take_pa_last20',
            'firstpstrike_pa_last20',
            'secondpstrike_pa_last20',
            'zoneedge_in2_p_last20',
            'zoneedge_in4_p_last20',
            'zoneedge_out2_p_last20',
            'zoneedge_out4_p_last20',
            'zonecorn_in2_p_last20',
            'zonecorn_in4_p_last20',
            'zonecorn_out2_p_last20',
            'zonecorn_out4_p_last20',
            'zone_mid3_p_last20',
            'zone_mid6_p_last20',
            'zone_bigmiss4_p_last20',
            'fastball_p_last20',
            'fastball_endspeed_p_last20',
            'fastball_spinrate_p_last20',
            'fastball_spindir_p_last20',
            'fastball_pfx_x_p_last20',
            'fastball_pfx_z_p_last20',
            'fastball_mnorm_p_last20',
            'fastball_adjmnorm_p_last20',
            'curveball_p_last20',
            'curveball_endspeed_p_last20',
            'curveball_spinrate_p_last20',
            'curveball_spindir_p_last20',
            'curveball_pfx_x_p_last20',
            'curveball_pfx_z_p_last20',
            'curveball_mnorm_p_last20',
            'curveball_adjmnorm_p_last20',
            'slider_p_last20',
            'slider_endspeed_p_last20',
            'slider_spinrate_p_last20',
            'slider_spindir_p_last20',
            'slider_pfx_x_p_last20',
            'slider_pfx_z_p_last20',
            'slider_mnorm_p_last20',
            'slider_adjmnorm_p_last20',
            'changeup_p_last20',
            'changeup_endspeed_p_last20',
            'changeup_spinrate_p_last20',
            'changeup_spindir_p_last20',
            'changeup_pfx_x_p_last20',
            'changeup_pfx_z_p_last20',
            'changeup_mnorm_p_last20',
            'changeup_adjmnorm_p_last20'
            #'createddate',
            #'lastmodifieddate',
            #'autoincrement_PK'
            ]


        self.team_columnarray_off = [

            'outsmade_pa_std_off',
            'hits_pa_std_off',
            'obp_std_off',
            'tba_pa_std_off',
            'tba_o_std_off',
            'runsscored_pa_std_off',
            'outsmade_pa_std_sp_off',
            'hits_pa_std_sp_off',
            'obp_std_sp_off',
            'tba_pa_std_sp_off',
            'tba_o_std_sp_off',
            'runsscored_pa_std_sp_off',
            'outsmade_pa_std_rp_off',
            'hits_pa_std_rp_off',
            'obp_std_rp_off',
            'tba_pa_std_rp_off',
            'tba_o_std_rp_off',
            'runsscored_pa_std_rp_off',
            'outsmade_pa_std_home_off',
            'hits_pa_std_home_off',
            'obp_std_home_off',
            'tba_pa_std_home_off',
            'tba_o_std_home_off',
            'runsscored_pa_std_home_off',
            'outsmade_pa_std_away_off',
            'hits_pa_std_away_off',
            'obp_std_away_off',
            'tba_pa_std_away_off',
            'tba_o_std_away_off',
            'runsscored_pa_std_away_off',
            'outsmade_pa_last60_off',
            'hits_pa_last60_off',
            'obp_last60_off',
            'tba_pa_last60_off',
            'tba_o_last60_off',
            'runsscored_pa_last60_off',
            'outsmade_pa_last30_off',
            'hits_pa_last30_off',
            'obp_last30_off',
            'tba_pa_last30_off',
            'tba_o_last30_off',
            'runsscored_pa_last30_off',
            'outsmade_pa_last10_off',
            'hits_pa_last10_off',
            'obp_last10_off',
            'tba_pa_last10_off',
            'tba_o_last10_off',
            'runsscored_pa_last10_off',
            'outsmade_pa_last60_rp_off',
            'hits_pa_last60_rp_off',
            'obp_last60_rp_off',
            'tba_pa_last60_rp_off',
            'tba_o_last60_rp_off',
            'runsscored_pa_last60_rp_off',
            'outsmade_pa_last60_sp_off',
            'hits_pa_last60_sp_off',
            'obp_last60_sp_off',
            'tba_pa_last60_sp_off',
            'tba_o_last60_sp_off',
            'runsscored_pa_last60_sp_off',
            'outsmade_pa_last30_sp_off',
            'hits_pa_last30_sp_off',
            'obp_last30_sp_off',
            'tba_pa_last30_sp_off',
            'tba_o_last30_sp_off',
            'runsscored_pa_last30_sp_off',
            'outsmade_pa_last30_rp_off',
            'hits_pa_last30_rp_off',
            'obp_last30_rp_off',
            'tba_pa_last30_rp_off',
            'tba_o_last30_rp_off',
            'runsscored_pa_last30_rp_off',
            'outsmade_pa_last10_sp_off',
            'hits_pa_last10_sp_off',
            'obp_last10_sp_off',
            'tba_pa_last10_sp_off',
            'tba_o_last10_sp_off',
            'runsscored_pa_last10_sp_off',
            'outsmade_pa_last10_rp_off',
            'hits_pa_last10_rp_off',
            'obp_last10_rp_off',
            'tba_pa_last10_rp_off',
            'tba_o_last10_rp_off',
            'runsscored_pa_last10_rp_off'
            ]

        self.team_columnarray_def = [

            'outsmade_pa_std_def',
            'hits_pa_std_def',
            'obp_std_def',
            'tba_pa_std_def',
            'tba_o_std_def',
            'runsscored_pa_std_def',
            'outsmade_pa_std_sp_def',
            'hits_pa_std_sp_def',
            'obp_std_sp_def',
            'tba_pa_std_sp_def',
            'tba_o_std_sp_def',
            'runsscored_pa_std_sp_def',
            'outsmade_pa_std_rp_def',
            'hits_pa_std_rp_def',
            'obp_std_rp_def',
            'tba_pa_std_rp_def',
            'tba_o_std_rp_def',
            'runsscored_pa_std_rp_def',
            'outsmade_pa_std_home_def',
            'hits_pa_std_home_def',
            'obp_std_home_def',
            'tba_pa_std_home_def',
            'tba_o_std_home_def',
            'runsscored_pa_std_home_def',
            'outsmade_pa_std_away_def',
            'hits_pa_std_away_def',
            'obp_std_away_def',
            'tba_pa_std_away_def',
            'tba_o_std_away_def',
            'runsscored_pa_std_away_def',
            'outsmade_pa_last60_def',
            'hits_pa_last60_def',
            'obp_last60_def',
            'tba_pa_last60_def',
            'tba_o_last60_def',
            'runsscored_pa_last60_def',
            'outsmade_pa_last30_def',
            'hits_pa_last30_def',
            'obp_last30_def',
            'tba_pa_last30_def',
            'tba_o_last30_def',
            'runsscored_pa_last30_def',
            'outsmade_pa_last10_def',
            'hits_pa_last10_def',
            'obp_last10_def',
            'tba_pa_last10_def',
            'tba_o_last10_def',
            'runsscored_pa_last10_def',
            'outsmade_pa_last60_sp_def',
            'hits_pa_last60_sp_def',
            'obp_last60_sp_def',
            'tba_pa_last60_sp_def',
            'tba_o_last60_sp_def',
            'runsscored_pa_last60_sp_def',
            'outsmade_pa_last60_rp_def',
            'hits_pa_last60_rp_def',
            'obp_last60_rp_def',
            'tba_pa_last60_rp_def',
            'tba_o_last60_rp_def',
            'runsscored_pa_last60_rp_def',
            'outsmade_pa_last30_sp_def',
            'hits_pa_last30_sp_def',
            'obp_last30_sp_def',
            'tba_pa_last30_sp_def',
            'tba_o_last30_sp_def',
            'runsscored_pa_last30_sp_def',
            'outsmade_pa_last30_rp_def',
            'hits_pa_last30_rp_def',
            'obp_last30_rp_def',
            'tba_pa_last30_rp_def',
            'tba_o_last30_rp_def',
            'runsscored_pa_last30_rp_def',
            'outsmade_pa_last10_sp_def',
            'hits_pa_last10_sp_def',
            'obp_last10_sp_def',
            'tba_pa_last10_sp_def',
            'tba_o_last10_sp_def',
            'runsscored_pa_last10_sp_def',
            'outsmade_pa_last10_rp_def',
            'hits_pa_last10_rp_def',
            'obp_last10_rp_def',
            'tba_pa_last10_rp_def',
            'tba_o_last10_rp_def',
            'runsscored_pa_last10_rp_def'
            ]

        self.batterhands_columnarray = ['bats']
        
        self.pitcherhands_columnarray = ['rl']

        self.batters = ''
        self.batters_joins = ''
        self.pitchers = ''
        self.pitchers_joins = ''
        self.teams = ''
        self.teams_joins = ''
        self.batterhands = ''
        self.pitcherhands = ''
    
        for side in self.sides:
            for batpos in self.batpositions:

                self.batters_joins += "LEFT JOIN anal_batter_rate AS anal_batter_rate_"+side+"_"+batpos+" ON anal_batter_rate_"+side+"_"+batpos+".anal_game_date = g.game_date AND anal_batter_rate_"+side+"_"+batpos+".batter = anal_startinglineup."+side+"_"+batpos+"_id_ "

                for col in self.batter_columnarray:
                    line = "anal_batter_rate_"+side+"_"+batpos+"."+col+" as "+col+"_"+side+"_"+batpos+","
                    self.batters += line
                for col in self.batterhands_columnarray:
                    line = "anal_startinglineup."+side+"_"+batpos+"_"+col+" as "+col+"_"+side+"_"+batpos+","
                    self.batterhands += line    

            self.pitchers_joins += ("""
                    LEFT JOIN anal_pitcher_rate AS anal_pitcher_rate_"""+side+"""
                    ON anal_pitcher_rate_"""+side+""".anal_game_date = g.game_date
                    AND anal_pitcher_rate_"""+side+""".pitcher = anal_startinglineup."""+side+"""_sp_id_ 
                    """)
            
            for col in self.pitcher_columnarray:
                line = "anal_pitcher_rate_"+side+"."+col+" as "+col+"_"+side+"_sp,"
                self.pitchers += line
            for col in self.pitcherhands_columnarray:
                line = "anal_startinglineup."+side+"_sp_"+col+" as "+col+"_"+side+"_sp,"
                self.pitcherhands += line
                
        
            self.teams_joins += "LEFT JOIN anal_team_rate AS anal_team_rate_"+side+" ON anal_team_rate_"+side+".anal_game_date = g.game_date AND anal_team_rate_"+side+".team_id = g."+side+"_id "

            for col in self.team_columnarray_off + self.team_columnarray_def:
                line = "anal_team_rate_"+side+"."+col+" as "+col+"_"+side+"_team,"
                self.teams += line       
                
        if inference_gids_str is None:
            self.inference_query = ''
        else:
            self.inference_query = """
                SELECT 
                g.gid,
                betting_lines.spread_home_oddsrat,
                betting_lines.spread_away_oddsrat,
                betting_lines.money_home_oddsrat,
                betting_lines.money_away_oddsrat,
                betting_lines.total_over_oddsrat,
                betting_lines.total_under_oddsrat,
                betting_lines.spread_home_points,
                betting_lines.spread_away_points,
                betting_lines.total_points,
                g.game_date,
                TIME_TO_SEC(g.home_time) as home_time,
                g.home_timezone,
                g.away_timedif,
                g.stad_id,
                home_w/(home_w+home_l) as home_wp, 
                away_w/(away_w+away_l) as away_wp,
                forecastio_weather.temperature,
                forecastio_weather.apparentTemperature,
                forecastio_weather.humidity,
                forecastio_weather.pressure,
                forecastio_weather.dewPoint,
                forecastio_weather.cloudCover,
                forecastio_weather.uvIndex,
                forecastio_weather.precipIntensity,
                forecastio_weather.precipProbability,
                forecastio_weather.windVector_ns,
                forecastio_weather.windVector_ew,
                forecastio_weather.precipType_rain,
                forecastio_weather.precipType_snow,
                forecastio_weather.precipType_sleet,
                """+self.batters+self.batterhands+self.pitchers+self.pitcherhands+self.teams+"""NULL AS to_drop 
                FROM anal_game AS g JOIN anal_startinglineup ON anal_startinglineup.game_date = g.game_date 
                AND anal_startinglineup.gid = g.gid """+self.batters_joins+self.pitchers_joins+self.teams_joins+""" 
                JOIN forecastio_weather ON forecastio_weather.gid = g.gid
                JOIN betting_lines ON betting_lines.gid = g.gid  
                WHERE game_type = 'R' AND betting_lines.book_id = 300
                AND g.gid IN ("""+inference_gids_str+""")
                ;"""
        
          
        if training_gids_str == 'all':   
            self.training_query = """
                SELECT 
                g.gid,
                betting_results.homevsspread,
                betting_results.awayvsspread,
                betting_results.spread_winner,
                betting_results.spread_home_oddsrat,
                betting_results.spread_away_oddsrat,
                betting_results.money_winner,
                betting_results.money_home_oddsrat,
                betting_results.money_away_oddsrat,
                betting_results.total_winner,
                betting_results.total_over_oddsrat,
                betting_results.total_under_oddsrat,
                betting_results.spread_home_points,
                betting_results.spread_away_points,
                betting_results.total_points,
                g.game_date,
                TIME_TO_SEC(g.home_time) as home_time,
                g.home_timezone,
                g.away_timedif,
                g.stad_id,
                home_w/(home_w+home_l) as home_wp, 
                away_w/(away_w+away_l) as away_wp,
                forecastio_weather.temperature,
                forecastio_weather.apparentTemperature,
                forecastio_weather.humidity,
                forecastio_weather.pressure,
                forecastio_weather.dewPoint,
                forecastio_weather.cloudCover,
                forecastio_weather.uvIndex,
                forecastio_weather.precipIntensity,
                forecastio_weather.precipProbability,
                forecastio_weather.windVector_ns,
                forecastio_weather.windVector_ew,
                forecastio_weather.precipType_rain,
                forecastio_weather.precipType_snow,
                forecastio_weather.precipType_sleet,
                """+self.batters+self.batterhands+self.pitchers+self.pitcherhands+self.teams+"""NULL AS to_drop 
                FROM anal_game AS g JOIN anal_startinglineup ON anal_startinglineup.game_date = g.game_date 
                AND anal_startinglineup.gid = g.gid """+self.batters_joins+self.pitchers_joins+self.teams_joins+""" 
                JOIN forecastio_weather ON forecastio_weather.gid = g.gid
                JOIN betting_results ON betting_results.gid = g.gid  
                WHERE game_type = 'R' AND betting_results.book_id = 300
                ;"""

        else:
            self.training_query = """
                SELECT 
                g.gid,
                betting_results.homevsspread,
                betting_results.awayvsspread,
                betting_results.spread_winner,
                betting_results.spread_home_oddsrat,
                betting_results.spread_away_oddsrat,
                betting_results.money_winner,
                betting_results.money_home_oddsrat,
                betting_results.money_away_oddsrat,
                betting_results.total_winner,
                betting_results.total_over_oddsrat,
                betting_results.total_under_oddsrat,
                betting_results.spread_home_points,
                betting_results.spread_away_points,
                betting_results.total_points,
                g.game_date,
                TIME_TO_SEC(g.home_time) as home_time,
                g.home_timezone,
                g.away_timedif,
                g.stad_id,
                home_w/(home_w+home_l) as home_wp, 
                away_w/(away_w+away_l) as away_wp,
                forecastio_weather.temperature,
                forecastio_weather.apparentTemperature,
                forecastio_weather.humidity,
                forecastio_weather.pressure,
                forecastio_weather.dewPoint,
                forecastio_weather.cloudCover,
                forecastio_weather.uvIndex,
                forecastio_weather.precipIntensity,
                forecastio_weather.precipProbability,
                forecastio_weather.windVector_ns,
                forecastio_weather.windVector_ew,
                forecastio_weather.precipType_rain,
                forecastio_weather.precipType_snow,
                forecastio_weather.precipType_sleet,
                """+self.batters+self.batterhands+self.pitchers+self.pitcherhands+self.teams+"""NULL AS to_drop 
                FROM anal_game AS g JOIN anal_startinglineup ON anal_startinglineup.game_date = g.game_date 
                AND anal_startinglineup.gid = g.gid """+self.batters_joins+self.pitchers_joins+self.teams_joins+""" 
                JOIN forecastio_weather ON forecastio_weather.gid = g.gid
                JOIN betting_results ON betting_results.gid = g.gid  
                WHERE game_type = 'R' AND betting_results.book_id = 300
                AND g.gid IN ("""+training_gids_str+""")
                ;"""
                  
                
        self.dummyscore_cols = []
        self.dummyscores = np.linspace(-25,25,51)
        for num in self.dummyscores:
            newcolname = "hs-as_"+str(int(num))
            self.dummyscore_cols.append(newcolname)

        self.dummytots_cols = []
        self.dummytots = np.linspace(0,50,51)
        for num in self.dummytots:
            newcolname = "hs+as_"+str(int(num))
            self.dummytots_cols.append(newcolname)

        self.dummyhomescore_cols = []
        self.dummyhomescores = np.linspace(0,25,26)
        for num in self.dummyhomescores:
            newcolname = "hs_"+str(int(num))
            self.dummyhomescore_cols.append(newcolname)

        self.dummyawayscore_cols = []
        self.dummyawayscores = np.linspace(0,25,26)
        for num in self.dummyawayscores:
            newcolname = "as_"+str(int(num))
            self.dummyawayscore_cols.append(newcolname)      
        


# In[ ]:




# In[ ]:




# In[ ]:




# In[ ]:



